      pipeline {
        agent {label 'sonarqube'}
        stages {
          stage("build & SonarQube analysis") {
            steps {
              withSonarQubeEnv('SonarScanner') {
                    dir("/CICD/JenkinsWar") { 
                sh '''
                      export JAVA_HOME=/usr/lib/jvm/java-1.8.0-openjdk-1.8.0.312.b07-1.el7_9.x86_64
                      mvn clean package -DskipTests
                      export JAVA_HOME=/usr/lib/jvm/java-11-openjdk-11.0.14.0.9-1.el7_9.x86_64
                      mvn sonar:sonar \
                      -Dsonar.projectKey=SonarQube-Github \
                      -Dsonar.host.url=http://10.107.65.162:9000 \
                      -Dsonar.login=2995027c03cf7062285e53a3150a90ba0f846dbc
                   '''
                }
              }
            }
          }
         }
       }

